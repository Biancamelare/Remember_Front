<app-sidenav></app-sidenav>
<app-model-financeiro (transacaoSalva)="recarregarTransacoes()" [transacao]="transacaoSelecionado"></app-model-financeiro>
<div class="main-vizualizar">
    <header>
        <div class="search-container">
            <input type="text" class="form-control search-input" placeholder="Pesquisar transação financeira" aria-label="Recipient's username" aria-describedby="button-addon2" [(ngModel)]="transacaoFiltro" (input)="transacaoChange()">
                <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16" id="icon">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                </svg>
        </div>

        <div class="userDrop">
            <div class="icon-user">
                <img [src]="stringBase64" width="40px" height="50px" alt="foto do usuario">
            </div>

            <div class="dropdown">
                <button class="dropbtn">
                    {{this.nome}} 
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-caret-down-fill" viewBox="0 0 16 16"><path d="M7.247 11.14 2.451 5.658C1.885 5.013 2.345 4 3.204 4h9.592a1 1 0 0 1 .753 1.659l-4.796 5.48a1 1 0 0 1-1.506 0z"/>
                </svg></button>

                <div class="dropdown-content">
                    <div class="xpmenu">
                    <span class="nome">{{this.nome}} </span>
                    <span class="xp">{{this.xp}} XP </span>                       
                    </div>
                    
                    <hr>

                    <a href="configuracoes"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16"><path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/><path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/></svg> Meu Perfil</a>
                    
                    <hr>
                    <a href="login"><svg fill="#0C2377" height="20" width="20" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 511.989 511.989" xml:space="preserve" stroke="#0C2377" stroke-width="13.311714"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g> <g> <g> <path d="M110.933,221.782c-4.71,0-8.533,3.823-8.533,8.533v51.2c0,4.71,3.823,8.533,8.533,8.533s8.533-3.823,8.533-8.533v-51.2 C119.467,225.605,115.644,221.782,110.933,221.782z"></path> <path d="M111.855,2.304L31.172,34.586C8.448,43,0,54.418,0,76.715v358.477c0,22.298,8.448,33.715,30.959,42.061l81.058,32.427 c4.011,1.519,8.038,2.287,11.981,2.287c17.152,0,29.602-14.336,29.602-34.091V34.049C153.6,9.78,134.246-6.126,111.855,2.304z M136.533,477.876c0,10.18-5.035,17.024-12.535,17.024c-1.869,0-3.883-0.401-5.803-1.118L37.103,461.33 c-16.102-5.965-20.036-11.102-20.036-26.138V76.715c0-15.036,3.934-20.164,20.241-26.206l80.725-32.29 c2.082-0.785,4.087-1.186,5.956-1.186c7.501,0,12.544,6.835,12.544,17.016V477.876z"></path> <path d="M178.133,51.115h120.533c14.114,0,25.6,11.486,25.6,25.6v128c0,4.71,3.814,8.533,8.533,8.533 c4.719,0,8.533-3.823,8.533-8.533v-128c0-23.526-19.14-42.667-42.667-42.667H178.133c-4.71,0-8.533,3.823-8.533,8.533 S173.423,51.115,178.133,51.115z"></path> <path d="M332.8,298.582c-4.719,0-8.533,3.823-8.533,8.533v128c0,14.114-11.486,25.6-25.6,25.6H179.2 c-4.71,0-8.533,3.823-8.533,8.533s3.823,8.533,8.533,8.533h119.467c23.526,0,42.667-19.14,42.667-42.667v-128 C341.333,302.405,337.519,298.582,332.8,298.582z"></path> <path d="M511.343,252.655c-0.435-1.05-1.058-1.988-1.852-2.782l-85.325-85.333c-3.337-3.336-8.73-3.336-12.066,0 c-3.337,3.337-3.337,8.73,0,12.066l70.767,70.775H196.267c-4.71,0-8.533,3.823-8.533,8.533c0,4.71,3.823,8.533,8.533,8.533 h286.601L412.1,335.215c-3.337,3.337-3.337,8.73,0,12.066c1.664,1.664,3.849,2.5,6.033,2.5c2.185,0,4.369-0.836,6.033-2.5 l85.325-85.325c0.794-0.794,1.417-1.732,1.852-2.782C512.205,257.093,512.205,254.738,511.343,252.655z"></path> </g> </g> </g> </g></svg>  Desconectar</a>
                </div>
            </div>
        </div>
    </header>

    <div id="info">
        <div id="titulo">
            <h2>Controle Financeiro</h2>
        </div>
        
        <div id="btnAdicionar">
            <button type="button" class="btn adicionar" data-bs-toggle="modal" (click)="openModal()" data-bs-target="#modalTransacao">
                <svg xmlns="http://www.w3.org/2000/svg" width="35" height="35" fill="currentColor" class="bi bi-plus" viewBox="0 0 16 16"> <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4"/></svg> Nova Transação
            </button>
        </div>
    </div>

    <div class="busca">
        <div class="data">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-calendar-week-fill" viewBox="0 0 16 16">
                <path d="M4 .5a.5.5 0 0 0-1 0V1H2a2 2 0 0 0-2 2v1h16V3a2 2 0 0 0-2-2h-1V.5a.5.5 0 0 0-1 0V1H4zM16 14V5H0v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M9.5 7h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5m3 0h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5M2 10.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3.5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5"/>
            </svg>
            <label>Data</label>
            <input type="date" [(ngModel)]="vencimento_em" (input)="dataChange()">
            <span><svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16" id="icon2">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                </svg></span>
        </div>
        <div class="pesquisa">
            <input type="text" class="form-control search-input2" placeholder="Pesquisar por categoria" aria-label="Recipient's username" aria-describedby="button-addon2" [(ngModel)]="categoriaFiltro" (input)="categoriaChange()" >
                <svg xmlns="http://www.w3.org/2000/svg" width="23" height="23" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16" id="icon2">
                <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001q.044.06.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1 1 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0"/>
                </svg>
        </div>

    </div>

    <div class="main-center">
        <div class="resumo">
            <div class="tabela">
                <div id="saldo todos" class="geral">
                    <h4>Saldo atual</h4>
                    <label for="" [ngClass]="{'positivo': saldoAtual >= 0, 'negativo': saldoAtual < 0}"> {{ tirarVirgula(saldoAtual)}}</label>
                </div>
            </div>

            <div class="tabela">
                <div title="Clique para filtrar as transações financeiras do tipo Entrada" id="entradas" class="geral positivo" (click)="filtrarPorTipo('d')" [ngClass]="{'ativo': tipoFiltro === 'd'}">
                    <h4>Entradas</h4>
                    <label for=""> {{ tirarVirgula(entradas)}}</label>
                </div>
            </div>
            
            <div class="tabela">
                <div title="Clique para filtrar as transações financeiras do tipo Saída" id="saidas" class="geral negativo" (click)="filtrarPorTipo('c')" [ngClass]="{'ativo': tipoFiltro === 'c'}">
                    <h4>Saídas</h4>
                    <label for=""> {{tirarVirgula(saidas)}}</label>
                </div>
            </div>
           
        </div>
        
        <div class="transacoes" id="scroll">
            <div class="transacao titulo">
                <label id="descricao" >Descrição</label>
                <label id="valor" >Valor</label>
                <label id="categoria">Categoria</label>
                <label id="data">Data</label>
            </div>
            <div class="transacao" *ngFor="let transacao of transacoes" >
                <label id="descricao" (click)="selecionarTransacao(transacao)" data-bs-toggle="modal" data-bs-target="#modalTransacao">{{transacao.descricao}}</label>
                <label for="" id="valor" [ngClass]="{'positivo': transacao.tipo === 'd', 'negativo': transacao.tipo === 'c'}">{{ formatarValor(transacao.preco, transacao.tipo) }}</label>
                <label for="" id="categoria">{{transacao.categoria}}</label>
                <label for="" id="data">{{formatarData(transacao.vencimento_em)}}</label>
            </div>
        </div>
    </div>